---
title: Message
description: What is a message?
sidebar:
   order: 30
---

import { Tabs, TabItem, Aside } from '@astrojs/starlight/components';
import Jdoclink from '../../../../components/jdoclink.astro';

Messages are the core building blocks of Fluxzero. They represent the data that flows through your application, such as commands, events, and queries.

## types

Fluxzero defines several types of messages:

- **Command**: A message that represents a request to change the state of the system.
- **Event**: A message that represents a notification that something has happened in the system.
- **Query**: A message that represents a request for information from the system.
- **Response**: A message that represents the result of a query or command.
- **Metric**: A message that represents a measurement or statistic about the system.

## metadata

Messages in Fluxzero can carry additional information, known as metadata. 
This metadata can be used to provide context about the message, such as authentication details, user agent information, or correlation IDs.]

Fluxzero provides a <Jdoclink className="Metadata" /> class that allows you to attach key-value pairs to messages. 

### Passing metadata

You can pass metadata when sending commands, events, or queries. For example:

<Tabs>
<TabItem label="Java">  

```java
FluxCapacitor.sendCommand(
    new AddLight("Living Room #1"),
    Metadata.of("source", "admin-ui")
);
```
</TabItem>
<TabItem label="Kotlin">
```kotlin
FluxCapacitor.sendCommand(
      AddLight("Living Room #1"),   
      Metadata.of("source", "admin-ui")
)
```
</TabItem>
</Tabs>

<Aside type="caution">
Metadata is not automatically propagated; you will have to explicitly pass it along when sending messages.
Metadata is only propagated if the respectieve <Jdoclink className="CorrelationDataProvider" /> propgagates it. See [Propagating Metadata](/guides/propagating-metadata) on how to implement this.
</Aside>

### Reading metadata
You can also get metadata by injecting the `Metadata` class into your command or event handler.

<Tabs>
<TabItem label="Java">
```java
import org.fluxcapacitor.common.Metadata;

public class MyCommandHandler {

    public void handle(MyCommand command, Metadata metadata) {
        // Access metadata
        String source = metadata.get("source");
        // ...
    }
}
```
</TabItem>
<TabItem label="Kotlin">
```kotlin
import org.fluxcapacitor.common.Metadata  

class MyCommandHandler {

    fun handle(command: MyCommand, metadata: Metadata) {
        // Access metadata
        val source = metadata["source"]
        // ...
    }
}
```
</TabItem>
</Tabs>


### Fluxzero metadata

Flux reserves `$` as a prefix for metadata property names. 
You are allowed to use the `$` prefix for your own metadata properties, but this is unsupported and therefore we recommend to use a different prefix to avoid conflicts with Fluxzero's internal metadata properties.

By default, Fluxzero adds the following metadata properties to all messages:
- `$applicationId` – ID of the application this client belongs to (optional)
- `$clientId` – Unique identifier for this Flux client instance
- `$clientName` – Logical name of the client (e.g. "service-A")
- `$consumer` – Consumer name of the current Tracker, if active
- `$tracker` – Unique ID of the current Tracker, if active
- `$correlationId` – ID used to correlate this message with the currently handled message (message index or ID if index is unavailable)
- `$traceId` – ID representing the trace this message belongs to (usually inherited from the message root)
- `$trigger` – Fully qualified class name of the message that triggered this one
- `$triggerType` – Type of the triggering message (e.g. COMMAND, QUERY, etc.)
- `$invocation` – ID of the current handler Invocation, if any


See <Jdoclink className="CorrelationDataProvider" /> for the full list of metadata properties that are propagated by default.
